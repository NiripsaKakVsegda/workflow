<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/scheduler_style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
    <script src="https://kit.fontawesome.com/0d348efd9b.js" crossorigin="anonymous"></script>
    <title>Workflow</title>
</head>
<body>
    <header style="background: #f2c078; color: #FFF;">
        <div class="header-part">
            <i class="fa-solid fa-bars fa-3x" style="color: #fff; cursor: pointer" onclick="moveNavHorizontal('sidenav', true)"></i>
            <h1>Workflow</h1>
        </div>
        <div class="header-part" onclick="moveNavVertical('dropmenu')">
            <img src={{avatar}} class="avatar">
            <h2 style="font-weight: 400; font-size: 28px"> {{username}} </h2>
        </div>
    </header>
    <div id="sidenav" class="sidenav">
        <nav style="padding-top: 30px;">
            <a href="/main"><i class="fa-solid fa-house"></i>Главная</a>
            <a href="/schedule"><i class="fa-solid fa-bars-progress"></i>Задачи</a>
            <a href="/groups"><i class="fa-solid fa-graduation-cap"></i>Группы</a>
            <a href="#"><i class="fa-solid fa-user-group"></i>Друзья</a>
            <a href="#"><i class="fa-solid fa-comment"></i>Сообщения</a>
        </nav>
        <nav>
            <a href="#" class="settings"><i class="fa-solid fa-screwdriver-wrench"></i>Настройки</a>
        </nav>
    </div>

    <div style="display: flex; justify-content: flex-end;">
        <div id="dropmenu" class="dropmenu">
            <nav>
                <a href="/account"><i class="fa-solid fa-user" style="color: #fff"></i>Аккаунт</a>
                <a href="/auth/login"><i class="fa-solid fa-arrow-right-from-bracket" style="color: #fff"></i>Выход</a> <!-- как-то организовать выход из системы -->
            </nav>
        </div>
    </div>
    <div class="content" id="content" style="display: flex; flex-direction: column; gap: 60px">
        <div style="display: flex; gap: 10px; align-items: center; justify-content: flex-end; padding: 10px 20px 0 0">
            <p style="font-weight: 600; font-size: 30px; color: #1E0E62">Задачи на:
                <b style="font-weight: 600; font-size: 30px; color: #7EBC89; cursor: pointer">неделю
                    <i class="fa-solid fa-caret-down fa"></i></b></p>
        </div>
        <div class="table">
            <div class="item" ondblclick="addNewTask(document.getElementById('Monday').textContent)">
                <p>Понедельник</p>
                <p class="date date-1" id="Monday"></p>
                {{{tasksDay0}}}
            </div>
            <div class="item" ondblclick="addNewTask(document.getElementById('Tuesday').textContent)">
                <p>Вторник</p>
                <p class="date date-2" id="Tuesday"></p>
                {{{tasksDay1}}}
            </div>
            <div class="item" ondblclick="addNewTask(document.getElementById('Wednesday').textContent)">
                <p>Среда</p>
                <p class="date date-3" id="Wednesday"></p>
                {{{tasksDay2}}}
            </div>
            <div class="item" ondblclick="addNewTask(document.getElementById('Thursday').textContent)">
                <p>Четверг</p>
                <p class="date date-4" id="Thursday"></p>
                {{{tasksDay3}}}
            </div>
            <div class="item" ondblclick="addNewTask(document.getElementById('Friday').textContent)">
                <p>Пятница</p>
                <p class="date date-5" id="Friday"></p>
                {{{tasksDay4}}}
            </div>
            <div class="item" ondblclick="addNewTask(document.getElementById('Saturday').textContent)">
                <p>Суббота</p>
                <p class="date date-6" id="Saturday"></p>
                {{{tasksDay5}}}
            </div>
            <div class="item" ondblclick="addNewTask(document.getElementById('Sunday').textContent)">
                <p>Воскресенье</p>
                <p class="date date-7" id="Sunday"></p>
                {{{tasksDay6}}}
            </div>
            <div class="item" ondblclick="document.getElementById('modal-new-task-without-time').style.display = 'flex'">
                <p style="margin-bottom: 10px;">Прочее</p>
                {{{tasksNoTime}}}
            </div>
        </div>
    </div>

    {{{taskModals}}}

    <div class="modal-container" id="modal-new-task">
        <div class="modal" style="display: flex; flex-direction: column; gap: 20px;">
            <div style="display: flex; justify-content: space-between">
                <input required type="text" style="font-weight: 300; font-size: 64px;" placeholder="Название">
                <i class="fa-solid fa-xmark fa-2x" onclick="document.getElementById('modal-new-task').style.display = 'none'"></i>
            </div>
            <div style="display: flex; align-items: center; gap: 20px">
                <i class="fa-solid fa-clock fa-3x"></i>
                <p style="font-weight: 300;font-size: 40px" id="newTaskDate"></p>
                <input style="font-weight: 300;font-size: 40px" type="time" placeholder="15:00">
            </div>
            <textarea class="task-text" style="resize: none; font-weight: 300;font-size: 40px; height: 300px; overflow: auto; max-width: 100%; border: none; outline: none" placeholder="Что нужно сделать?"></textarea>
            <div style="display: flex; justify-content: space-between; margin-top: 40px">
                <i class="fa-solid fa-trash fa-3x"></i>
                <i class="fa-solid fa-check fa-3x" onclick="document.getElementById('modal-new-task').style.display = 'none'"></i>
            </div>
        </div>
    </div>

    <div class="modal-container" id="modal-new-task-without-time">
        <div class="modal" style="display: flex; flex-direction: column; gap: 20px;">
            <div style="display: flex; justify-content: space-between">
                <input required type="text" style="font-weight: 300; font-size: 64px;" placeholder="Название">
                <i class="fa-solid fa-xmark fa-2x" onclick="document.getElementById('modal-new-task-without-time').style.display = 'none'"></i>
            </div>
            <textarea class="task-text" style="resize: none; font-weight: 300;font-size: 40px; height: 300px; overflow: auto; max-width: 100%; border: none; outline: none" placeholder="Что нужно сделать?"></textarea>
            <div style="display: flex; justify-content: space-between; margin-top: 40px">
                <i class="fa-solid fa-trash fa-3x"></i>
                <i class="fa-solid fa-check fa-3x" onclick="document.getElementById('modal-new-task-without-time').style.display = 'none'"></i>
            </div>
        </div>
    </div>


    <footer style="color: #1E0E62; font-weight: 500; font-size: 26px; position: fixed; bottom: 10px; right: 10px">
        <p id="time" > </p>
        <script src="js/time.js">   </script>
        <script src="js/current_week.js"></script>
    </footer>

    <script>
        function fillWeekdays() {
            let weekdays = getWeekdays();
            for (let i = 0; i < 7; i++) {
                const weekday = weekdays[i].toLocaleString();
                const element = document.getElementsByClassName('date date-' + (i + 1))[0];
                element.innerText = weekday.substring(0, 5);
            }
        }
        fillWeekdays();

        function moveNavVertical(id) {
            if (document.getElementById(id).style.height === "160px") {
                document.getElementById(id).style.height = "0";
            }
            else {
                document.getElementById(id).style.height = "160px";
            }
        }

        function moveNavHorizontal(id, margin) {
            if (document.getElementById(id).style.width === "280px") {
                document.getElementById(id).style.width = "0";
                if (margin) {
                    document.getElementById("content").style.marginLeft = "40px";
                }
            }
            else {
                document.getElementById(id).style.width = "280px";
                if (margin) {
                    document.getElementById("content").style.marginLeft = "320px";
                }
            }
        }

        function openModal(id) {
            if (!e) var e = window.event;
            e.cancelBubble = true;
            if (e.stopPropagation) e.stopPropagation();
            document.getElementById(id).style.display = 'flex';
        }

        function addNewTask(date) {
            document.getElementById('modal-new-task').style.display = 'flex'
            document.getElementById('newTaskDate').textContent = date
        }
    </script>
</body>
</html>
